<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="SyndicApp.Mobile.Views.Affectations.AffectationCreatePage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:layout="clr-namespace:SyndicApp.Mobile.Views.Layout"
    xmlns:vm="clr-namespace:SyndicApp.Mobile.ViewModels.Affectations"
    Title="Nouvelle affectation"
    Shell.NavBarIsVisible="False"
    BackgroundColor="White">

    <layout:RoleDrawerLayout>
        <layout:RoleDrawerLayout.MainContent>

            <ScrollView>
                <VerticalStackLayout Padding="16"
                                     Spacing="16">

                    <!-- TITRE -->
                    <Label Text="Nouvelle affectation"
                           FontSize="22"
                           FontAttributes="Bold" />

                    <!-- UTILISATEUR -->
                    <VerticalStackLayout Spacing="4">
                        <Label Text="Utilisateur"
                               FontSize="12"
                               TextColor="#6B7280" />

                        <Picker ItemsSource="{Binding Users}"
                                ItemDisplayBinding="{Binding Label}"
                                SelectedItem="{Binding SelectedUser}"
                                Title="Choisir un utilisateur"
                                BackgroundColor="#F3F4F6"
                                TextColor="#111827" />
                    </VerticalStackLayout>

                    <!-- LOT -->
                    <VerticalStackLayout Spacing="4">
                        <Label Text="Lot"
                               FontSize="12"
                               TextColor="#6B7280" />

                        <Picker ItemsSource="{Binding Lots}"
                                ItemDisplayBinding="{Binding NumeroLot}"
                                SelectedItem="{Binding SelectedLot}"
                                Title="Choisir un lot"
                                BackgroundColor="#F3F4F6"
                                TextColor="#111827" />
                    </VerticalStackLayout>

                    <!-- DATES -->
                    <Grid ColumnDefinitions="*,*"
                          ColumnSpacing="12">

                        <!-- DATE DÉBUT -->
                        <VerticalStackLayout Grid.Column="0" Spacing="4">
                            <Label Text="Date de début"
                                   FontSize="12"
                                   TextColor="#6B7280" />

                            <DatePicker Date="{Binding DateDebut}"
                                        BackgroundColor="#F3F4F6"
                                        TextColor="#111827" />
                        </VerticalStackLayout>

                        <!-- DATE FIN -->
                        <VerticalStackLayout Grid.Column="1" Spacing="4">
                            <Label Text="Date de fin (optionnelle)"
                                   FontSize="12"
                                   TextColor="#6B7280" />

                            <DatePicker Date="{Binding DateFin}"
                                        IsEnabled="{Binding HasDateFin}"
                                        BackgroundColor="#F3F4F6"
                                        TextColor="#111827" />
                        </VerticalStackLayout>

                    </Grid>

                    <!-- PROPRIÉTAIRE -->
                    <Grid ColumnDefinitions="Auto,*"
                          Margin="0,8,0,0">
                        <Label Grid.Column="0"
                               Text="Propriétaire"
                               VerticalOptions="Center" />

                        <Switch Grid.Column="1"
                                HorizontalOptions="Start"
                                IsToggled="{Binding EstProprietaire}" />
                    </Grid>

                    <!-- BOUTONS -->
                    <Grid ColumnDefinitions="*,*"
                          Margin="0,24,0,0"
                          ColumnSpacing="12">

                        <!-- ANNULER -->
                        <Button Grid.Column="0"
                                Text="Annuler"
                                BackgroundColor="Transparent"
                                TextColor="#2563EB"
                                BorderColor="#2563EB"
                                BorderWidth="1"
                                CornerRadius="10"
                                Padding="14,10"
                                Clicked="OnCancelClicked" />

                        <!-- ENREGISTRER -->
                        <Button x:Name="BtnSave"
                                Grid.Column="1"
                                Text="Enregistrer"
                                BackgroundColor="#2563EB"
                                TextColor="White"
                                CornerRadius="10"
                                Padding="14,10"
                                Clicked="OnSaveClicked" />
                    </Grid>

                </VerticalStackLayout>
            </ScrollView>

        </layout:RoleDrawerLayout.MainContent>
    </layout:RoleDrawerLayout>
</ContentPage>
