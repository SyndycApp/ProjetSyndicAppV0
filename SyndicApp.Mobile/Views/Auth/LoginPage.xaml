<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="SyndicApp.Mobile.Views.Auth.LoginPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:viewmodels="clr-namespace:SyndicApp.Mobile.ViewModels.Auth"
    x:DataType="viewmodels:LoginViewModel"
    Title="Connexion"
    BackgroundColor="{DynamicResource PageBackgroundColor}">

    <ScrollView>
        <Grid Padding="24" RowDefinitions="Auto,Auto">
            <!-- Header + Brand -->
            <VerticalStackLayout Spacing="8" Grid.Row="0" HorizontalOptions="Center">
                <Image Source="appicon.png" HeightRequest="64" WidthRequest="64" Aspect="AspectFit"/>
                <Label Text="Se connecter" FontSize="24" FontAttributes="Bold" HorizontalTextAlignment="Center"/>
                <Label Text="{Binding ServerMessage}" TextColor="Red" IsVisible="{Binding HasError}"/>
            </VerticalStackLayout>

            <!-- Form -->
            <VerticalStackLayout Spacing="12" Grid.Row="1" Margin="0,16,0,0">
                <Entry Placeholder="Email" Text="{Binding Email}" Keyboard="Email"/>
                <Grid>
                    <Entry Placeholder="Mot de passe" Text="{Binding Password}" IsPassword="{Binding !ShowPassword}"/>
                    <Button Text="{Binding ShowPassword, Converter={StaticResource BoolToShowHideTextConverter}}"
                            WidthRequest="90" HeightRequest="36"
                            HorizontalOptions="End" VerticalOptions="Center"
                            Command="{Binding ToggleShowPasswordCommand}" />
                </Grid>

                <HorizontalStackLayout VerticalOptions="Center">
                    <CheckBox IsChecked="{Binding RememberMe}" />
                    <Label Text="Se souvenir de moi" VerticalTextAlignment="Center"/>
                </HorizontalStackLayout>

                <Button Text="Se connecter" Command="{Binding LoginCommand}" />

                <Grid ColumnDefinitions="*,*" Margin="0,6,0,0">
                    <Button Text="Mot de passe oublié ?" StyleClass="LinkButton"
                            Command="{Binding GoForgotPasswordCommand}" />
                    <Button Text="Créer un compte" StyleClass="LinkButton" Grid.Column="1"
                            Command="{Binding GoRegisterCommand}" />
                </Grid>
            </VerticalStackLayout>
        </Grid>
    </ScrollView>
</ContentPage>
