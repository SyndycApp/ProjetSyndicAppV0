<?xml version="1.0" encoding="utf-8"?>
<ContentPage
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:vm="clr-namespace:SyndicApp.Mobile.ViewModels.Auth"
    x:Class="SyndicApp.Mobile.Views.Auth.LoginPage"
    x:DataType="vm:LoginViewModel"
    Shell.NavBarIsVisible="False"
    BackgroundColor="#F4F6F8">

    <Grid Padding="20">
        <Border HorizontalOptions="Center"
                VerticalOptions="Center"
                WidthRequest="420"
                StrokeThickness="0"
                BackgroundColor="White"
                Padding="24"
                StrokeShape="RoundRectangle 16">
            <Border.Shadow>
                <Shadow Brush="#40000000" Radius="12" />
            </Border.Shadow>

            <ScrollView>
                <VerticalStackLayout Spacing="16">

                    <!-- Logo + Titre -->
                    <VerticalStackLayout Spacing="8" HorizontalOptions="Center">
                        <Image Source="logo.png" WidthRequest="64" HeightRequest="64" Aspect="AspectFit"/>
                        <Label Text="Connexion"
                               FontSize="26"
                               FontAttributes="Bold"
                               TextColor="#1C1C1E"
                               HorizontalOptions="Center"/>
                    </VerticalStackLayout>

                    <!-- Bandeau d'erreur -->
                    <Border BackgroundColor="#FDECEA"
                            StrokeThickness="0"
                            Padding="10"
                            StrokeShape="RoundRectangle 8"
                            IsVisible="{Binding HasError}">
                        <Label Text="{Binding ErrorMessage}"
                               TextColor="#B3261E"
                               FontSize="13"
                               LineBreakMode="WordWrap"/>
                    </Border>

                    <!-- Champs -->
                    <VerticalStackLayout Spacing="12">

                        <VerticalStackLayout Spacing="6">
                            <Label Text="Email" FontSize="12" TextColor="#6B7280"/>
                            <Border StrokeShape="RoundRectangle 8"
                                    BackgroundColor="#FFFFFF"
                                    Padding="12">
                                <Entry Text="{Binding Email}"
                                       Keyboard="Email"
                                       Placeholder="email@exemple.com"
                                       TextColor="Black"
                                       BackgroundColor="Transparent"/>
                            </Border>
                        </VerticalStackLayout>

                        <VerticalStackLayout Spacing="6">
                            <Label Text="Mot de passe" FontSize="12" TextColor="#6B7280"/>
                            <Border StrokeShape="RoundRectangle 8"
                                    BackgroundColor="#FFFFFF"
                                    Padding="12">
                                <Entry Text="{Binding Password}"
                                       IsPassword="True"
                                       Placeholder="••••••••"
                                       TextColor="Black"
                                       BackgroundColor="Transparent"/>
                            </Border>
                        </VerticalStackLayout>

                        <!-- Lien mot de passe oublié -->
                        <Label Text="Mot de passe oublié ?"
                               TextColor="#1E63E9"
                               HorizontalOptions="End"
                               FontSize="13">
                            <Label.GestureRecognizers>
                                <TapGestureRecognizer Command="{Binding GoToForgotPasswordCommand}" />
                            </Label.GestureRecognizers>
                        </Label>
                    </VerticalStackLayout>

                    <!-- Bouton principal -->
                    <Button Text="Se connecter"
                            Command="{Binding LoginCommand}"
                            HeightRequest="48"
                            FontAttributes="Bold"
                            TextColor="White"
                            BackgroundColor="#1E63E9"
                            CornerRadius="12"/>

                    <!-- Loader -->
                    <ActivityIndicator IsRunning="{Binding IsBusy}"
                                       IsVisible="{Binding IsBusy}"
                                       Color="#1E63E9"/>

                    <!-- Lien vers inscription -->
                    <HorizontalStackLayout HorizontalOptions="Center"
                                            Spacing="6"
                                            Margin="0,4,0,0">
                        <Label Text="Pas de compte ?" TextColor="#6B7280" />
                        <Label Text="Créer un compte"
                               TextColor="#1E63E9"
                               FontAttributes="Bold">
                            <Label.GestureRecognizers>
                                <TapGestureRecognizer Command="{Binding GoToRegisterCommand}" />
                            </Label.GestureRecognizers>
                        </Label>
                    </HorizontalStackLayout>

                </VerticalStackLayout>
            </ScrollView>
        </Border>
    </Grid>
</ContentPage>
