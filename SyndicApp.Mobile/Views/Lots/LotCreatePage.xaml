<?xml version="1.0" encoding="utf-8" ?>
<ContentPage x:Class="SyndicApp.Mobile.Views.Lots.LotCreatePage"
             xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             Title="Créer Lot" Shell.NavBarIsVisible="False" BackgroundColor="White">
  <ContentPage.Resources>
    <Color x:Key="TopbarColor">#2563EB</Color>
    <Color x:Key="HeaderTextOnDark">#FFFFFF</Color>
    <Color x:Key="BodyText">#111827</Color>
    <Style TargetType="Label"><Setter Property="TextColor" Value="{StaticResource BodyText}"/></Style>
  </ContentPage.Resources>

  <Grid x:Name="Root" RowDefinitions="Auto,*">
    <Grid BackgroundColor="{StaticResource TopbarColor}" Padding="12,8">
      <Grid.ColumnDefinitions><ColumnDefinition Width="Auto"/><ColumnDefinition Width="*"/><ColumnDefinition Width="Auto"/></Grid.ColumnDefinitions>
      <Button Grid.Column="0" Text="☰" FontSize="22" BackgroundColor="Transparent"
              TextColor="{StaticResource HeaderTextOnDark}" Clicked="OpenDrawer_Clicked"/>
      <Label Grid.Column="1" Text="Créer Lot" HorizontalTextAlignment="Center"
             VerticalOptions="Center" FontAttributes="Bold" TextColor="{StaticResource HeaderTextOnDark}"/>
      <Label Grid.Column="2" Text="• • •" TextColor="{StaticResource HeaderTextOnDark}" VerticalOptions="Center"/>
    </Grid>

    <ScrollView Grid.Row="1">
      <VerticalStackLayout Padding="16" Spacing="14">
        <Label Text="Numéro du lot" FontAttributes="Bold"/>
        <Entry Text="{Binding NumeroLot}" TextColor="#111827" PlaceholderColor="#9CA3AF"/>

        <Label Text="Type" FontAttributes="Bold"/>
        <Entry Text="{Binding Type}" TextColor="#111827" PlaceholderColor="#9CA3AF"/>

        <Label Text="Surface" FontAttributes="Bold"/>
        <Entry Keyboard="Numeric" Text="{Binding Surface}" TextColor="#111827" PlaceholderColor="#9CA3AF"/>

        <Label Text="Résidence" FontAttributes="Bold"/>
        <Picker ItemsSource="{Binding Residences}" ItemDisplayBinding="{Binding Nom}"
                SelectedItem="{Binding SelectedResidence}" SelectedIndexChanged="ResidenceChanged"/>

        <Label Text="Bâtiment" FontAttributes="Bold"/>
        <Picker ItemsSource="{Binding Batiments}" ItemDisplayBinding="{Binding Nom}"
                SelectedItem="{Binding SelectedBatiment}"/>

        <Grid ColumnDefinitions="*,*" ColumnSpacing="12" Margin="0,16,0,0">
          <Button Text="Annuler" Command="{Binding CancelCommand}" />
          <Button Grid.Column="1" Text="Créer" BackgroundColor="#2563EB" TextColor="White"
                  Command="{Binding CreateCommand}" />
        </Grid>
      </VerticalStackLayout>
    </ScrollView>

    <!-- Overlay + Drawer -->
    <BoxView x:Name="Backdrop" Grid.RowSpan="2" BackgroundColor="#66000000" Opacity="0" InputTransparent="True">
      <BoxView.GestureRecognizers><TapGestureRecognizer Tapped="Backdrop_Tapped"/></BoxView.GestureRecognizers>
    </BoxView>
    <Border x:Name="Drawer" Grid.RowSpan="2" BackgroundColor="White" StrokeThickness="0" TranslationX="-1000" Padding="0">
      <Grid RowDefinitions="Auto,*">
        <Grid BackgroundColor="{StaticResource TopbarColor}" Padding="16">
          <Grid.ColumnDefinitions><ColumnDefinition Width="*"/><ColumnDefinition Width="Auto"/></Grid.ColumnDefinitions>
          <Label Text="Navigation" TextColor="{StaticResource HeaderTextOnDark}" FontAttributes="Bold" VerticalOptions="Center"/>
          <Button Grid.Column="1" Text="→" BackgroundColor="Transparent" TextColor="{StaticResource HeaderTextOnDark}" Clicked="CloseDrawer_Clicked"/>
        </Grid>
       <ScrollView Grid.Row="1" BackgroundColor="White">
					<VerticalStackLayout Padding="16" Spacing="10">

						<!-- DASHBOARD -->
						<Label Text="Tableau de bord" FontAttributes="Bold"/>
						<Button Text="Dashboard"
								Style="{StaticResource MenuButtonStyle}"
								CommandParameter="//syndic-dashboard"
								Clicked="OnMenuItemClicked"/>

						<!-- RÉSIDENCES / LOTS -->
						<BoxView HeightRequest="1" BackgroundColor="{StaticResource Divider}" />
						<Label Text="Résidences &amp; Lots" FontAttributes="Bold"/>
						<Button Text="Résidences"            Style="{StaticResource MenuButtonStyle}" CommandParameter="//residences"                    Clicked="OnMenuItemClicked"/>
						<Button Text="Bâtiments"              Style="{StaticResource MenuButtonStyle}" CommandParameter="//batiments"                     Clicked="OnMenuItemClicked"/>
						<Button Text="Lots"                   Style="{StaticResource MenuButtonStyle}" CommandParameter="//lots"                          Clicked="OnMenuItemClicked"/>
						<Button Text="Affectations des lots"  Style="{StaticResource MenuButtonStyle}" CommandParameter="//affectations-lots"            Clicked="OnMenuItemClicked"/>
						<Button Text="Occupant actuel"        Style="{StaticResource MenuButtonStyle}" CommandParameter="//lots/occupant-actuel"         Clicked="OnMenuItemClicked"/>
						<Button Text="Historique affectations" Style="{StaticResource MenuButtonStyle}" CommandParameter="//lots/affectations/historique" Clicked="OnMenuItemClicked"/>

						<!-- FINANCES -->
						<BoxView HeightRequest="1" BackgroundColor="{StaticResource Divider}" />
						<Label Text="Finances" FontAttributes="Bold"/>

						<!-- Liste principale des appels -->
						<Button Text="Appels de fonds"
								Style="{StaticResource MenuButtonStyle}"
								CommandParameter="//appels"
								Clicked="OnMenuItemClicked"/>

						<!-- Création d’un nouvel appel -->
						<Button Text="Créer un appel"
								Style="{StaticResource MenuButtonStyle}"
								CommandParameter="appel-create"
								Clicked="OnMenuItemClicked"/>

						<!-- Modification d’un appel -->
						<Button Text="Modifier un appel"
								Style="{StaticResource MenuButtonStyle}"
								CommandParameter="appel-edit"
								Clicked="OnMenuItemClicked"/>

						<!-- Détails d’un appel -->
						<Button Text="Détails d’un appel"
								Style="{StaticResource MenuButtonStyle}"
								CommandParameter="appel-details"
								Clicked="OnMenuItemClicked"/>


						<!-- INCIDENTS / INTERVENTIONS / DEVIS -->
						<BoxView HeightRequest="1" BackgroundColor="{StaticResource Divider}" />
						<Label Text="Incidents &amp; Interventions" FontAttributes="Bold"/>
						<Button Text="Incidents"               Style="{StaticResource MenuButtonStyle}" CommandParameter="//incidents"       Clicked="OnMenuItemClicked"/>
						<Button Text="Interventions"           Style="{StaticResource MenuButtonStyle}" CommandParameter="//interventions"   Clicked="OnMenuItemClicked"/>
						<Button Text="Devis de travaux"        Style="{StaticResource MenuButtonStyle}" CommandParameter="//devis-travaux"   Clicked="OnMenuItemClicked"/>
						<Button Text="Prestataires"            Style="{StaticResource MenuButtonStyle}" CommandParameter="//prestataires"     Clicked="OnMenuItemClicked"/>

						<!-- ASSEMBLÉES GÉNÉRALES -->
						<BoxView HeightRequest="1" BackgroundColor="{StaticResource Divider}" />
						<Label Text="Assemblées Générales" FontAttributes="Bold"/>
						<Button Text="Convocations"            Style="{StaticResource MenuButtonStyle}" CommandParameter="//ag/convocations"  Clicked="OnMenuItemClicked"/>
						<Button Text="Ordre du jour"           Style="{StaticResource MenuButtonStyle}" CommandParameter="//ag/ordre-du-jour" Clicked="OnMenuItemClicked"/>
						<Button Text="Votes"                   Style="{StaticResource MenuButtonStyle}" CommandParameter="//ag/votes"         Clicked="OnMenuItemClicked"/>
						<Button Text="Décisions"               Style="{StaticResource MenuButtonStyle}" CommandParameter="//ag/decisions"     Clicked="OnMenuItemClicked"/>
						<Button Text="Procès-verbal (PV)"      Style="{StaticResource MenuButtonStyle}" CommandParameter="//ag/pv"            Clicked="OnMenuItemClicked"/>

						<!-- DOCUMENTS / ANNONCES -->
						<BoxView HeightRequest="1" BackgroundColor="{StaticResource Divider}" />
						<Label Text="Documents &amp; Annonces" FontAttributes="Bold"/>
						<Button Text="Documents"               Style="{StaticResource MenuButtonStyle}" CommandParameter="//documents"             Clicked="OnMenuItemClicked"/>
						<Button Text="Catégories de documents" Style="{StaticResource MenuButtonStyle}" CommandParameter="//documents/categories" Clicked="OnMenuItemClicked"/>
						<Button Text="Annonces"                Style="{StaticResource MenuButtonStyle}" CommandParameter="//annonces"             Clicked="OnMenuItemClicked"/>
						<Button Text="Catégories d'annonces"   Style="{StaticResource MenuButtonStyle}" CommandParameter="//annonces/categories"  Clicked="OnMenuItemClicked"/>

						<!-- MESSAGERIE -->
						<BoxView HeightRequest="1" BackgroundColor="{StaticResource Divider}" />
						<Label Text="Messagerie" FontAttributes="Bold"/>
						<Button Text="Conversations"           Style="{StaticResource MenuButtonStyle}" CommandParameter="//messages/conversations" Clicked="OnMenuItemClicked"/>
						<Button Text="Messages"                Style="{StaticResource MenuButtonStyle}" CommandParameter="//messages"              Clicked="OnMenuItemClicked"/>

						<!-- PERSONNEL -->
						<BoxView HeightRequest="1" BackgroundColor="{StaticResource Divider}" />
						<Label Text="Personnel" FontAttributes="Bold"/>
						<Button Text="Employés"                Style="{StaticResource MenuButtonStyle}" CommandParameter="//personnel/employes"   Clicked="OnMenuItemClicked"/>
						<Button Text="Plannings &amp; Présences" Style="{StaticResource MenuButtonStyle}" CommandParameter="//personnel/plannings" Clicked="OnMenuItemClicked"/>

						<!-- RECRUTEMENT -->
						<BoxView HeightRequest="1" BackgroundColor="{StaticResource Divider}" />
						<Label Text="Recrutement" FontAttributes="Bold"/>
						<Button Text="Offres d'emploi"         Style="{StaticResource MenuButtonStyle}" CommandParameter="//recrutement/offres"       Clicked="OnMenuItemClicked"/>
						<Button Text="Candidatures"            Style="{StaticResource MenuButtonStyle}" CommandParameter="//recrutement/candidatures" Clicked="OnMenuItemClicked"/>

						<!-- MARKETPLACE -->
						<BoxView HeightRequest="1" BackgroundColor="{StaticResource Divider}" />
						<Label Text="Marketplace" FontAttributes="Bold"/>
						<Button Text="Annonces de biens"       Style="{StaticResource MenuButtonStyle}" CommandParameter="//marketplace/biens"   Clicked="OnMenuItemClicked"/>
						<Button Text="Demandes"                Style="{StaticResource MenuButtonStyle}" CommandParameter="//marketplace/demandes" Clicked="OnMenuItemClicked"/>

						<!-- NOTIFICATIONS -->
						<BoxView HeightRequest="1" BackgroundColor="{StaticResource Divider}" />
						<Label Text="Notifications" FontAttributes="Bold"/>
						<Button Text="Centre de notifications"  Style="{StaticResource MenuButtonStyle}" CommandParameter="//notifications" Clicked="OnMenuItemClicked"/>

						<!-- UTILISATEURS & RÔLES -->
						<BoxView HeightRequest="1" BackgroundColor="{StaticResource Divider}" />
						<Label Text="Utilisateurs &amp; Rôles" FontAttributes="Bold"/>
						<Button Text="Utilisateurs"            Style="{StaticResource MenuButtonStyle}" CommandParameter="//admin/utilisateurs" Clicked="OnMenuItemClicked"/>
						<Button Text="Rôles &amp; Permissions" Style="{StaticResource MenuButtonStyle}" CommandParameter="//admin/roles"        Clicked="OnMenuItemClicked"/>

						<!-- PARAMÈTRES / AIDE -->
						<BoxView HeightRequest="1" BackgroundColor="{StaticResource Divider}" />
						<Label Text="Paramètres" FontAttributes="Bold"/>
						<Button Text="Profil"                  Style="{StaticResource MenuButtonStyle}" CommandParameter="//settings/profil"      Clicked="OnMenuItemClicked"/>
						<Button Text="Préférences"             Style="{StaticResource MenuButtonStyle}" CommandParameter="//settings/preferences" Clicked="OnMenuItemClicked"/>
						<Button Text="À propos &amp; Support"  Style="{StaticResource MenuButtonStyle}" CommandParameter="//settings/a-propos"    Clicked="OnMenuItemClicked"/>

						<!-- DÉCONNEXION (simple retour login ; pour un vrai logout, gère le TokenStore côté VM) -->
						<BoxView HeightRequest="16" Opacity="0"/>
						<Button Text="Déconnexion"
								Style="{StaticResource LogoutButtonStyle}"
								CommandParameter="//login"
								Clicked="OnMenuItemClicked"/>
					</VerticalStackLayout>
				</ScrollView>
      </Grid>
    </Border>
  </Grid>
</ContentPage>
