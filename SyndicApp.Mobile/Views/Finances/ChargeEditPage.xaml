<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="SyndicApp.Mobile.Views.Finances.ChargeEditPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:viewmodels="clr-namespace:SyndicApp.Mobile.ViewModels.Finances"
    xmlns:layout="clr-namespace:SyndicApp.Mobile.Views.Layout"
    x:DataType="viewmodels:ChargeEditViewModel"
    Title="Modifier charge"
    Shell.NavBarIsVisible="False"
    BackgroundColor="White">

    <ContentPage.Resources>
        <Color x:Key="TopbarColor">#2563EB</Color>
        <Color x:Key="HeaderTextOnDark">#FFFFFF</Color>
        <Color x:Key="BodyText">#111827</Color>
        <Color x:Key="Divider">#E5E7EB</Color>
        <Color x:Key="Chip">#F3F4F6</Color>

        <Style TargetType="Label">
            <Setter Property="TextColor" Value="{StaticResource BodyText}" />
        </Style>

        <Style TargetType="Entry">
            <Setter Property="TextColor" Value="{StaticResource BodyText}" />
            <Setter Property="BackgroundColor" Value="Transparent" />
        </Style>

        <Style TargetType="Picker">
            <Setter Property="TextColor" Value="{StaticResource BodyText}" />
        </Style>

        <Style TargetType="DatePicker">
            <Setter Property="TextColor" Value="{StaticResource BodyText}" />
        </Style>
    </ContentPage.Resources>

    <layout:RoleDrawerLayout>
        <layout:RoleDrawerLayout.MainContent>

            <Grid RowDefinitions="Auto,*"
                  BackgroundColor="White">

                <!-- Topbar local -->
                <Grid BackgroundColor="White"
                      Padding="12,8"
                      ColumnDefinitions="Auto,*,Auto">
                    <Button Text="←"
                            FontSize="20"
                            BackgroundColor="Transparent"
                            TextColor="{StaticResource TopbarColor}"
                            Clicked="OnBackClicked" />

                    <Label Grid.Column="1"
                           Text="Modifier charge"
                           HorizontalTextAlignment="Center"
                           VerticalOptions="Center"
                           FontAttributes="Bold"
                           TextColor="{StaticResource BodyText}" />

                    <Label Grid.Column="2"
                           Text=" "
                           IsVisible="False" />
                </Grid>

                <!-- FORM -->
                <ScrollView Grid.Row="1"
                            Padding="16">
                    <VerticalStackLayout Spacing="14">

                        <!-- Nom -->
                        <Label Text="Nom de la charge" />
                        <Border Stroke="Black"
                                StrokeThickness="1"
                                Margin="0,2,0,8"
                                Padding="4">
                            <Border.StrokeShape>
                                <RoundRectangle CornerRadius="8" />
                            </Border.StrokeShape>
                            <Entry Placeholder="Ex : Eau, Électricité..."
                                   Text="{Binding Nom}" />
                        </Border>

                        <!-- Montant -->
                        <Label Text="Montant (MAD)" />
                        <Border Stroke="Black"
                                StrokeThickness="1"
                                Margin="0,2,0,8"
                                Padding="4">
                            <Border.StrokeShape>
                                <RoundRectangle CornerRadius="8" />
                            </Border.StrokeShape>
                            <Entry Keyboard="Numeric"
                                   Placeholder="0,00"
                                   Text="{Binding Montant}" />
                        </Border>

                        <!-- Date -->
                        <Label Text="Date de la charge" />
                        <Border Stroke="Black"
                                StrokeThickness="1"
                                Margin="0,2,0,8"
                                Padding="4">
                            <Border.StrokeShape>
                                <RoundRectangle CornerRadius="8" />
                            </Border.StrokeShape>
                            <DatePicker Date="{Binding DateCharge}" />
                        </Border>

                        <!-- Résidence -->
                        <Label Text="Résidence" />
                        <Border Stroke="Black"
                                StrokeThickness="1"
                                Margin="0,2,0,8"
                                Padding="4">
                            <Border.StrokeShape>
                                <RoundRectangle CornerRadius="8" />
                            </Border.StrokeShape>
                            <Picker Title="Choisir une résidence"
                                    ItemsSource="{Binding Residences}"
                                    SelectedItem="{Binding SelectedResidence}" />
                        </Border>

                        <!-- Bouton Enregistrer -->
                        <Button Text="Enregistrer les modifications"
                                Margin="0,16,0,0"
                                CornerRadius="10"
                                Padding="14,10"
                                BackgroundColor="{StaticResource TopbarColor}"
                                TextColor="White"
                                FontAttributes="Bold"
                                Command="{Binding SaveCommand}" />
                    </VerticalStackLayout>
                </ScrollView>

            </Grid>

        </layout:RoleDrawerLayout.MainContent>
    </layout:RoleDrawerLayout>
</ContentPage>
