<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="SyndicApp.Mobile.Views.Dashboard.AffectationMaintenanceDashboardPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:layout="clr-namespace:SyndicApp.Mobile.Views.Layout"
    Shell.NavBarIsVisible="False"
    BackgroundColor="White">

    <layout:RoleDrawerLayout x:Name="DrawerLayout">

        <layout:RoleDrawerLayout.MainContent>

            <ScrollView Padding="16">
                <VerticalStackLayout Spacing="16">

                    <Label Text="Affectations (gardien)"
                           FontSize="22"
                           FontAttributes="Bold" />

                    <!-- Occupants actuels -->
                    <Frame Style="{StaticResource Card}">
                        <VerticalStackLayout>
                            <Label Text="Occupants actuels"
                                   FontAttributes="Bold"/>

                            <CollectionView ItemsSource="{Binding CurrentOccupants}"
                                            SelectionMode="None">
                                <CollectionView.ItemTemplate>
                                    <DataTemplate>
                                        <Grid ColumnDefinitions="*,Auto" Padding="0,6">
                                            <Label Text="{Binding LotNumero}"
                                                   FontAttributes="Bold"/>
                                            <Label Grid.Column="1"
                                                   Text="{Binding UserNom}"/>
                                        </Grid>
                                    </DataTemplate>
                                </CollectionView.ItemTemplate>
                            </CollectionView>
                        </VerticalStackLayout>
                    </Frame>

                    <!-- Fin 30 jours -->
                    <Frame Style="{StaticResource Card}">
                        <VerticalStackLayout>
                            <Label Text="Fin dans 30 jours"
                                   FontAttributes="Bold"/>

                            <CollectionView ItemsSource="{Binding EndingSoon}"
                                            SelectionMode="None">
                                <CollectionView.ItemTemplate>
                                    <DataTemplate>
                                        <Grid ColumnDefinitions="*,Auto" Padding="0,6">
                                            <Label Text="{Binding LotNumero}"/>
                                            <Label Grid.Column="1"
                                                   Text="{Binding DateFin, StringFormat='{0:dd/MM/yyyy}'}"/>
                                        </Grid>
                                    </DataTemplate>
                                </CollectionView.ItemTemplate>
                            </CollectionView>
                        </VerticalStackLayout>
                    </Frame>

                    <!-- Clôturées récemment -->
                    <Frame Style="{StaticResource Card}">
                        <VerticalStackLayout>
                            <Label Text="Clôturées récemment"
                                   FontAttributes="Bold"/>

                            <CollectionView ItemsSource="{Binding RecentlyClosed}"
                                            SelectionMode="None">
                                <CollectionView.ItemTemplate>
                                    <DataTemplate>
                                        <Grid ColumnDefinitions="*,Auto" Padding="0,6">
                                            <Label Text="{Binding LotNumero}"/>
                                            <Label Grid.Column="1"
                                                   Text="{Binding DateFin, StringFormat='{0:dd/MM/yyyy}'}"/>
                                        </Grid>
                                    </DataTemplate>
                                </CollectionView.ItemTemplate>
                            </CollectionView>
                        </VerticalStackLayout>
                    </Frame>

                </VerticalStackLayout>
            </ScrollView>

        </layout:RoleDrawerLayout.MainContent>

    </layout:RoleDrawerLayout>

</ContentPage>
