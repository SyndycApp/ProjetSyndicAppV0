<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="SyndicApp.Mobile.Views.Incidents.InterventionDetailsPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:vm="clr-namespace:SyndicApp.Mobile.ViewModels.Incidents"
    xmlns:layout="clr-namespace:SyndicApp.Mobile.Views.Layout"
    x:DataType="vm:InterventionDetailsViewModel"
    x:Name="ThisPage"
    Shell.NavBarIsVisible="False"
    BackgroundColor="White">

    <layout:RoleDrawerLayout x:Name="DrawerLayout">
        <layout:RoleDrawerLayout.MainContent>

            <ScrollView>
                <VerticalStackLayout Padding="16" Spacing="16">

                    <Button Text="←"
                            FontSize="22"
                            BackgroundColor="Transparent"
                            TextColor="Black"
                            Clicked="Back_Clicked"/>

                    <Label Text="Détails intervention"
                           FontSize="22"
                           FontAttributes="Bold" />

                    <ActivityIndicator IsRunning="{Binding IsBusy}"
                                       IsVisible="{Binding IsBusy}" />

                    <Frame Padding="14" BorderColor="#E5E7EB" CornerRadius="14">
                        <VerticalStackLayout Spacing="8">

                            <Label Text="Description" FontAttributes="Bold" />
                            <Label Text="{Binding Item.DescriptionSansGuid}" />

                            <BoxView HeightRequest="1" BackgroundColor="#E5E7EB" />

                            <Label Text="Statut :" FontAttributes="Bold" />
                            <Label Text="{Binding Item.Statut}" />
                        </VerticalStackLayout>
                    </Frame>

                    <Frame Padding="14" BorderColor="#E5E7EB" CornerRadius="14">
                        <VerticalStackLayout>
                            <Label Text="Dates" FontAttributes="Bold" />
                            <Label Text="{Binding Item.DatePrevue, StringFormat='Prévue : {0:dd/MM/yyyy HH\\:mm}'}" Opacity="0.7" />
                            <Label Text="{Binding Item.DateRealisation, StringFormat='Réalisation : {0:dd/MM/yyyy HH\\:mm}'}" Opacity="0.7" />
                        </VerticalStackLayout>
                    </Frame>

                    <Frame Padding="14" BorderColor="#E5E7EB" CornerRadius="14">
                        <VerticalStackLayout Spacing="6">
                            <Label Text="Coûts" FontAttributes="Bold" />
                            <Label Text="{Binding Item.CoutEstime, StringFormat='Coût estimé : {0:F2}'}" Opacity="0.7"/>
                            <Label Text="{Binding Item.CoutReel, StringFormat='Coût réel : {0:F2}'}" Opacity="0.7"/>
                        </VerticalStackLayout>
                    </Frame>

                    <Frame Padding="14" BorderColor="#E5E7EB" CornerRadius="14">
                        <VerticalStackLayout Spacing="12">
                            <Label Text="Actions" FontAttributes="Bold" />

                            <HorizontalStackLayout Spacing="10">
                                <Button Text="Démarrer" Command="{Binding StartCommand}" BackgroundColor="#2563EB" TextColor="White"/>
                                <Button Text="Terminer" Command="{Binding CompleteCommand}" BorderWidth="1" BorderColor="#2563EB" TextColor="#2563EB"/>
                                <Button Text="Annuler" Command="{Binding CancelCommand}" BackgroundColor="#DC2626" TextColor="White"/>
                            </HorizontalStackLayout>
                        </VerticalStackLayout>
                    </Frame>

                </VerticalStackLayout>
            </ScrollView>

        </layout:RoleDrawerLayout.MainContent>
    </layout:RoleDrawerLayout>

</ContentPage>
