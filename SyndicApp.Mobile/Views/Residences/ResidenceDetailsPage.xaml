<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:layouts="clr-namespace:SyndicApp.Mobile.Views.Layout"
    xmlns:models="clr-namespace:SyndicApp.Mobile.Models"
    x:Class="SyndicApp.Mobile.Views.Residences.ResidenceDetailsPage"
    x:Name="RootPage"
    Title="Détails résidence"
    BackgroundColor="White"
    Shell.NavBarIsVisible="False">

    <!-- ==== RESSOURCES ==== -->
    <ContentPage.Resources>

        <Color x:Key="BodyText">#111827</Color>
        <Color x:Key="Chip">#F3F4F6</Color>

        <Style TargetType="Label">
            <Setter Property="TextColor" Value="{StaticResource BodyText}" />
        </Style>

    </ContentPage.Resources>

    <!-- ==== LAYOUT AVEC ROLE DRAWER ==== -->
    <layouts:RoleDrawerLayout>
        <layouts:RoleDrawerLayout.MainContent>

            <ScrollView>
                <VerticalStackLayout Padding="16" Spacing="14">

                    <!-- ====== TITRE ====== -->
                    <Label Text="{Binding Residence.Nom}"
                           FontSize="22"
                           FontAttributes="Bold" />

                    <Label Text="{Binding Residence.Adresse}" TextColor="#374151"/>
                    <Label Text="{Binding Residence.Ville}" TextColor="#374151"/>
                    <Label Text="{Binding Residence.CodePostal}" TextColor="#374151"/>

                    <!-- ====== LOTS ====== -->
                    <Label Text="Lots de la résidence"
                           FontAttributes="Bold"
                           Margin="0,16,0,4"/>

                    <CollectionView ItemsSource="{Binding Lots}">
                        <CollectionView.EmptyView>
                            <Label Text="Aucun lot pour cette résidence."
                                   TextColor="#6B7280"
                                   FontSize="13" />
                        </CollectionView.EmptyView>

                        <CollectionView.ItemTemplate>
                            <DataTemplate x:DataType="models:LotDto">
                                <Frame Margin="0,6,0,0"
                                       Padding="12"
                                       HasShadow="False"
                                       BackgroundColor="{StaticResource Chip}"
                                       CornerRadius="10">

                                    <VerticalStackLayout Spacing="4">
                                        <Label Text="{Binding NumeroLot}"
                                               FontAttributes="Bold" />

                                        <Label Text="{Binding Type}"
                                               FontSize="12"
                                               TextColor="#6B7280"/>

                                        <Label Text="{Binding Surface, StringFormat='Surface : {0} m²'}"
                                               FontSize="12"
                                               TextColor="#6B7280"/>
                                    </VerticalStackLayout>

                                </Frame>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>

                    <!-- ===== BOUTONS ===== -->
                    <Grid ColumnDefinitions="*,*" ColumnSpacing="12" Margin="0,20,0,0">
                        <Button Text="Modifier"
                                BackgroundColor="#2563EB"
                                TextColor="White"
                                CornerRadius="12"
                                Command="{Binding EditCommand}" />

                        <Button Grid.Column="1"
                                Text="Retour"
                                BackgroundColor="#E5E7EB"
                                TextColor="#111827"
                                CornerRadius="12"
                                Clicked="Back_Clicked" />
                    </Grid>

                    <!-- ===== SUPPRESSION ===== -->
                    <Button x:Name="DeleteButton"
                            Text="Supprimer"
                            BackgroundColor="#DC2626"
                            TextColor="White"
                            CornerRadius="12"
                            Margin="0,10,0,0"
                            Clicked="Delete_Clicked"/>

                </VerticalStackLayout>
            </ScrollView>

        </layouts:RoleDrawerLayout.MainContent>
    </layouts:RoleDrawerLayout>

</ContentPage>
