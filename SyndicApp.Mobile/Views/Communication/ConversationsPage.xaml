<?xml version="1.0" encoding="utf-8" ?>
<ContentPage 
    x:Class="SyndicApp.Mobile.Views.Communication.ConversationsPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:vm="clr-namespace:SyndicApp.Mobile.ViewModels.Communication"
    x:DataType="vm:ConversationsListViewModel"
    x:Name="RootPage"
    Shell.NavBarIsVisible="False"
    BackgroundColor="White">

    <CollectionView ItemsSource="{Binding Conversations}"
                    SelectionMode="None">

        <CollectionView.ItemTemplate>
            <DataTemplate>

                <Frame Padding="10"
                       Margin="0,0,0,10"
                       CornerRadius="12"
                       BackgroundColor="#F9FAFB"
                       BorderColor="#E5E7EB">

                    <Frame.GestureRecognizers>
                        <TapGestureRecognizer 
                            Command="{Binding BindingContext.ItemTappedCommand, Source={x:Reference RootPage}}"
                            CommandParameter="{Binding .}" />
                    </Frame.GestureRecognizers>

                    <Grid ColumnDefinitions="60,*">

                        <Frame WidthRequest="48" HeightRequest="48"
                               CornerRadius="24"
                               BackgroundColor="#2563EB"
                               VerticalOptions="Center">
                            <Label Text="{Binding Participants[1].NomComplet}"
                                   TextColor="White"
                                   HorizontalOptions="Center"
                                   VerticalOptions="Center"/>
                        </Frame>

                        <VerticalStackLayout Grid.Column="1" Spacing="4">
                            <Label Text="{Binding Participants[1].NomComplet}"
                                   FontSize="18"
                                   FontAttributes="Bold"/>

                            <Label Text="{Binding DernierMessage.Contenu}"
                                   TextColor="#6B7280"
                                   MaxLines="1"/>
                        </VerticalStackLayout>

                    </Grid>

                </Frame>

            </DataTemplate>
        </CollectionView.ItemTemplate>
    </CollectionView>

</ContentPage>
